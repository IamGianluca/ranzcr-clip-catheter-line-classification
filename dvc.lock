download_data:
  cmd: kaggle competitions download -c ranzcr-clip-catheter-line-classification -p
    data/
  outs:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
unzip_train_img:
  cmd: unzip data/ranzcr-clip-catheter-line-classification.zip 'train/*' -d 'data/'
  deps:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
  outs:
  - path: data/train/
    md5: 5571d6d885d1e550ac890552afb255f0.dir
    size: 6912613778
    nfiles: 30083
unzip_test_img:
  cmd: unzip data/ranzcr-clip-catheter-line-classification.zip 'test/*' -d 'data/'
  deps:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
  outs:
  - path: data/test/
    md5: ac6babfae020e79d81c0cd2ed33b7bd6.dir
    size: 844745721
    nfiles: 3583
unzip_train_labels:
  cmd: unzip data/ranzcr-clip-catheter-line-classification.zip 'train.csv' -d 'data/'
  deps:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
  outs:
  - path: data/train.csv
    md5: f9305cb1f8dbb233c78385f20ab3ae72
    size: 2918266
unzip_train_annotations:
  cmd: unzip data/ranzcr-clip-catheter-line-classification.zip 'train_annotations.csv'
    -d 'data/'
  deps:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
  outs:
  - path: data/train_annotations.csv
    md5: 00ad55b088b2f81c756a6b21bc8f2562
    size: 4950273
create_folds:
  cmd: python pipe/create_folds.py
  deps:
  - path: data/train.csv
    md5: f9305cb1f8dbb233c78385f20ab3ae72
    size: 2918266
  - path: pipe/create_folds.py
    md5: 388c48dce05c003baa66814be118e357
    size: 723
  outs:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
train_model_one:
  cmd: python pipe/train.py --fold 0
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: 95bc9b2ef6535e246e3addd4a3942f8f
    size: 4001
  params:
    params.yaml:
      train_resnet18_128:
        epochs: 20
        arch: resnet18
        metric: multilabel_auc_macro
        opt: adam
        loss: bce_with_logits
        precision: 16
        sz: 128
        bs: 1024
        lr: 0.02
        wd: 0.02
        mom: 0.9
  outs:
  - path: models/arch=resnet18_sz=128_fold=0.ckpt
    md5: 4e8bf53ecdc93a6ba660e27b3417f9ae
    size: 44787129
  - path: subs/oof/arch=resnet18_sz=128_fold=0.csv
    md5: f5bbdb7c829fe4e5ee0ed1f16ebefc00
    size: 985741
unzip_sample_submission:
  cmd: unzip data/ranzcr-clip-catheter-line-classification.zip 'sample_submission.csv'
    -d 'data/'
  deps:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
  outs:
  - path: data/sample_submission.csv
    md5: 3bf8eb33a1a25f1f79940d019c18ebbc
    size: 311839
resize_images:
  cmd: python pipe/resize_images.py
  deps:
  - path: data/test/
    md5: ac6babfae020e79d81c0cd2ed33b7bd6.dir
    size: 844745721
    nfiles: 3583
  - path: data/train/
    md5: 5571d6d885d1e550ac890552afb255f0.dir
    size: 6912613778
    nfiles: 30083
  outs:
  - path: data/test_1024/
    md5: 29b494965aebb0664b74e29f3e345473.dir
    size: 214944270
    nfiles: 3582
  - path: data/test_128/
    md5: 105566336a8298b416d0ef82e347051d.dir
    size: 8846772
    nfiles: 3582
  - path: data/test_192/
    md5: 7872b7646f388e9b08695138794c757a.dir
    size: 15818222
    nfiles: 3582
  - path: data/test_256/
    md5: 0a364a5a19354e2080a27411a6996ab5.dir
    size: 24363993
    nfiles: 3582
  - path: data/test_384/
    md5: 85def42fb4ea189dc50f2950f3b88965.dir
    size: 45232275
    nfiles: 3582
  - path: data/test_512/
    md5: 829fb8073ab10e5ace5d6d05253387b3.dir
    size: 70444379
    nfiles: 3582
  - path: data/test_768/
    md5: 9275cfb3acc8651983a9eb43ca03b174.dir
    size: 133274447
    nfiles: 3582
  - path: data/train_1024/
    md5: 2f49375e6e8e87e1fab5c5075d63b582.dir
    size: 1773270872
    nfiles: 30083
  - path: data/train_128/
    md5: 569de16f618eff737a4f2a8d3e70eec0.dir
    size: 72692224
    nfiles: 30083
  - path: data/train_192/
    md5: c480a05f5643a38909ccad7f71000599.dir
    size: 130326145
    nfiles: 30083
  - path: data/train_256/
    md5: e14002093f230017b4cc1810a53f0328.dir
    size: 201194414
    nfiles: 30083
  - path: data/train_384/
    md5: 142193318e2adfddd4fb6f8551589009.dir
    size: 374049179
    nfiles: 30083
  - path: data/train_512/
    md5: 088e837dc33da0b21e3f57644c085037.dir
    size: 582432616
    nfiles: 30083
  - path: data/train_768/
    md5: 8695f5a4249f99244a4c8c14e15eac0a.dir
    size: 1100286799
    nfiles: 30083
train_modlel_02:
  cmd: python pipe/train.py --fold 0 --epochs 20 --arch resnet34 --metric multilabel_auc_macro
    --opt adam --loss bce_with_logits --precision 16 --sz 128 --bs 512  --lr 0.02
    --wd 0.02 --mom 0.9
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: 07a367a146265f74db1e04c9d0a0d049
    size: 4289
  outs:
  - path: models/arch=resnet34_sz=128_fold=0.ckpt
    md5: 58672e048799379a17223652040325fd
    size: 85284057
  - path: subs/oof/arch=resnet34_sz=128_fold=0.csv
    md5: 125c6c3ae07a99c6d53e0830d10d2e2e
    size: 986208
train_resnet18_128:
  cmd: python pipe/train.py --fold 0 --epochs 20 --arch resnet18 --metric multilabel_auc_macro
    --opt adam --loss bce_with_logits --precision 16 --sz 128 --bs 1024 --lr 0.01
    --wd 0.02 --mom 0.9
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: 45798468a597d499c380eb4fbea00826
    size: 5414
  outs:
  - path: models/arch=resnet18_sz=128_fold=0.ckpt
    md5: afef3a7c1a3aa9eeb57df84b54c3d9f4
    size: 44786809
  - path: subs/arch=resnet18_sz=128_fold=0.csv
    md5: a9fddb22f41d8616e5b8d9a25db32f47
    size: 984835
  - path: subs/oof/arch=resnet18_sz=128_fold=0.csv
    md5: b6e6c8d30aa09692382da9d9d3b7c13a
    size: 1671856
train_resnet34_128:
  cmd: python pipe/train.py --fold 0 --epochs 20 --arch resnet34 --metric multilabel_auc_macro
    --opt adam --loss bce_with_logits --precision 16 --sz 128 --bs 512  --lr 0.005
    --wd 0.02 --mom 0.9
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: 07a367a146265f74db1e04c9d0a0d049
    size: 4289
  outs:
  - path: models/arch=resnet34_sz=128_fold=0.ckpt
    md5: aede888f4db0686caa40e4b2080c6b5e
    size: 85284057
  - path: subs/oof/arch=resnet34_sz=128_fold=0.csv
    md5: 893493cb64c231154c704ec92c047cf2
    size: 985863
train_resnet50_128:
  cmd: python pipe/train.py --fold 0 --epochs 20 --arch resnet50 --metric multilabel_auc_macro
    --opt adam --loss bce_with_logits --precision 16 --sz 128 --bs 256 --lr 0.0005
    --wd 0.02 --mom 0.9
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: 07a367a146265f74db1e04c9d0a0d049
    size: 4289
  outs:
  - path: models/arch=resnet50_sz=128_fold=0.ckpt
    md5: 7b22be203a1710cfdb6071b9095864ed
    size: 94425647
  - path: subs/oof/arch=resnet50_sz=128_fold=0.csv
    md5: a6fbb99529ff84ddb203d62abf9d365e
    size: 993347
