download_data:
  cmd: kaggle competitions download -c ranzcr-clip-catheter-line-classification -p
    data/
  outs:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
unzip_train_img:
  cmd: unzip data/ranzcr-clip-catheter-line-classification.zip 'train/*' -d 'data/'
  deps:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
  outs:
  - path: data/train/
    md5: 5571d6d885d1e550ac890552afb255f0.dir
    size: 6912613778
    nfiles: 30083
unzip_test_img:
  cmd: unzip data/ranzcr-clip-catheter-line-classification.zip 'test/*' -d 'data/'
  deps:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
  outs:
  - path: data/test/
    md5: ac6babfae020e79d81c0cd2ed33b7bd6.dir
    size: 844745721
    nfiles: 3583
unzip_train_labels:
  cmd: unzip data/ranzcr-clip-catheter-line-classification.zip 'train.csv' -d 'data/'
  deps:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
  outs:
  - path: data/train.csv
    md5: f9305cb1f8dbb233c78385f20ab3ae72
    size: 2918266
unzip_train_annotations:
  cmd: unzip data/ranzcr-clip-catheter-line-classification.zip 'train_annotations.csv'
    -d 'data/'
  deps:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
  outs:
  - path: data/train_annotations.csv
    md5: 00ad55b088b2f81c756a6b21bc8f2562
    size: 4950273
create_folds:
  cmd: python pipe/create_folds.py
  deps:
  - path: data/train.csv
    md5: f9305cb1f8dbb233c78385f20ab3ae72
    size: 2918266
  - path: pipe/create_folds.py
    md5: 388c48dce05c003baa66814be118e357
    size: 723
  outs:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
unzip_sample_submission:
  cmd: unzip data/ranzcr-clip-catheter-line-classification.zip 'sample_submission.csv'
    -d 'data/'
  deps:
  - path: data/ranzcr-clip-catheter-line-classification.zip
    md5: f8a117e7ba1b5527c99c80b54beddeb5
    size: 12561354247
  outs:
  - path: data/sample_submission.csv
    md5: 3bf8eb33a1a25f1f79940d019c18ebbc
    size: 311839
resize_images:
  cmd: python pipe/resize_images.py
  deps:
  - path: data/test/
    md5: ac6babfae020e79d81c0cd2ed33b7bd6.dir
    size: 844745721
    nfiles: 3583
  - path: data/train/
    md5: 5571d6d885d1e550ac890552afb255f0.dir
    size: 6912613778
    nfiles: 30083
  outs:
  - path: data/test_1024/
    md5: 29b494965aebb0664b74e29f3e345473.dir
    size: 214944270
    nfiles: 3582
  - path: data/test_128/
    md5: 105566336a8298b416d0ef82e347051d.dir
    size: 8846772
    nfiles: 3582
  - path: data/test_192/
    md5: 7872b7646f388e9b08695138794c757a.dir
    size: 15818222
    nfiles: 3582
  - path: data/test_256/
    md5: 0a364a5a19354e2080a27411a6996ab5.dir
    size: 24363993
    nfiles: 3582
  - path: data/test_384/
    md5: 85def42fb4ea189dc50f2950f3b88965.dir
    size: 45232275
    nfiles: 3582
  - path: data/test_512/
    md5: 829fb8073ab10e5ace5d6d05253387b3.dir
    size: 70444379
    nfiles: 3582
  - path: data/test_768/
    md5: 9275cfb3acc8651983a9eb43ca03b174.dir
    size: 133274447
    nfiles: 3582
  - path: data/train_1024/
    md5: 2f49375e6e8e87e1fab5c5075d63b582.dir
    size: 1773270872
    nfiles: 30083
  - path: data/train_128/
    md5: 569de16f618eff737a4f2a8d3e70eec0.dir
    size: 72692224
    nfiles: 30083
  - path: data/train_192/
    md5: c480a05f5643a38909ccad7f71000599.dir
    size: 130326145
    nfiles: 30083
  - path: data/train_256/
    md5: e14002093f230017b4cc1810a53f0328.dir
    size: 201194414
    nfiles: 30083
  - path: data/train_384/
    md5: 142193318e2adfddd4fb6f8551589009.dir
    size: 374049179
    nfiles: 30083
  - path: data/train_512/
    md5: 088e837dc33da0b21e3f57644c085037.dir
    size: 582432616
    nfiles: 30083
  - path: data/train_768/
    md5: 8695f5a4249f99244a4c8c14e15eac0a.dir
    size: 1100286799
    nfiles: 30083
train_modlel_02:
  cmd: python pipe/train.py --fold 0 --epochs 20 --arch resnet34 --metric multilabel_auc_macro
    --opt adam --loss bce_with_logits --precision 16 --sz 128 --bs 512  --lr 0.02
    --wd 0.02 --mom 0.9
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: 07a367a146265f74db1e04c9d0a0d049
    size: 4289
  outs:
  - path: models/arch=resnet34_sz=128_fold=0.ckpt
    md5: 58672e048799379a17223652040325fd
    size: 85284057
  - path: subs/oof/arch=resnet34_sz=128_fold=0.csv
    md5: 125c6c3ae07a99c6d53e0830d10d2e2e
    size: 986208
train_resnet18_128:
  cmd: python pipe/train.py --fold -1 --arch resnet18 --metric multilabel_auc_macro
    --opt sam --loss bce_with_logits --precision 16 --sz 128 --auto_batch_size power
    --lr 0.1 --sched plateau --mom 0.9 --wd 0.0
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: ab19123134b658160ea4df1b371b0e31
    size: 7072
  outs:
  - path: metrics/arch=resnet18_sz=128.metric
    md5: 642140559d3fc08a2f18565ffb94875e
    size: 31
  - path: models/arch=resnet18_sz=128_fold=0.ckpt
    md5: 3089f7b80bccc6a789f3a6cd6abde49c
    size: 44787010
  - path: models/arch=resnet18_sz=128_fold=1.ckpt
    md5: bbd2f4771acd65c2b771559c64c0a7f7
    size: 44787005
  - path: models/arch=resnet18_sz=128_fold=2.ckpt
    md5: 62bbb6bab2864518150c75c456995c0d
    size: 44787006
  - path: models/arch=resnet18_sz=128_fold=3.ckpt
    md5: b837be8f57e2b688c69f06899c4d4d53
    size: 44787005
  - path: models/arch=resnet18_sz=128_fold=4.ckpt
    md5: 1cd444ba777fef10718d93c52a84f91e
    size: 44787005
  - path: subs/arch=resnet18_sz=128_fold=0.csv
    md5: 8b8984bbff513dbffd64f80acb1bd0b2
    size: 994828
  - path: subs/arch=resnet18_sz=128_fold=1.csv
    md5: 2e496b15d042e1ffc805c8fbf3f9c432
    size: 998473
  - path: subs/arch=resnet18_sz=128_fold=2.csv
    md5: 48f891efb416e497fd9da72e8ed76858
    size: 996339
  - path: subs/arch=resnet18_sz=128_fold=3.csv
    md5: 9a19dc4a6d62859484b535f2b62037c6
    size: 996050
  - path: subs/arch=resnet18_sz=128_fold=4.csv
    md5: 236e13862f5be2f11fe6a55bb47aadda
    size: 994519
  - path: subs/oof/arch=resnet18_sz=128_fold=0.csv
    md5: 96c7527020836bc501468771310ab1f4
    size: 1686678
  - path: subs/oof/arch=resnet18_sz=128_fold=1.csv
    md5: e7b5cc1f59cc81cccee1fa7a0e66efa0
    size: 1680905
  - path: subs/oof/arch=resnet18_sz=128_fold=2.csv
    md5: aaf72abc05954cd354d819e66745f0da
    size: 1684539
  - path: subs/oof/arch=resnet18_sz=128_fold=3.csv
    md5: 7fef6a69d9ff9317d1c07fe55ff1f724
    size: 1679909
  - path: subs/oof/arch=resnet18_sz=128_fold=4.csv
    md5: 66a602e2b1b7d4b12d292eda2cf7a597
    size: 1686517
train_resnet34_128:
  cmd: python pipe/train.py --fold 0 --arch resnet34 --metric multilabel_auc_macro
    --opt sam --loss bce_with_logits --precision 16 --sz 128 --auto_batch_size power
    --lr 0.1 --lr_scheduler reduce_on_plateau --mom 0.9 --wd 0.0
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: 0598ad00f41707e969b91ec3f5b6fc6b
    size: 6109
  outs:
  - path: models/arch=resnet34_sz=128_fold=0.ckpt
    md5: 6b4628afe990056937e977a7a50e64c6
    size: 85283809
  - path: subs/arch=resnet34_sz=128_fold=0.csv
    md5: 5fa09f3be30944601692355e2b00f4de
    size: 992399
  - path: subs/oof/arch=resnet34_sz=128_fold=0.csv
    md5: 91984a21c504205f117fb2fbdb186961
    size: 1684459
train_resnet50_128:
  cmd: python pipe/train.py --fold 0 --arch resnet50 --metric multilabel_auc_macro
    --opt sam --loss bce_with_logits --precision 16 --sz 128 --auto_batch_size power
    --lr 0.1 --lr_scheduler reduce_on_plateau --mom 0.9 --wd 0.0
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: 0598ad00f41707e969b91ec3f5b6fc6b
    size: 6109
  outs:
  - path: models/arch=resnet50_sz=128_fold=0.ckpt
    md5: 204c1fb6dbcc285e5a2f264510de061b
    size: 94425410
  - path: subs/arch=resnet50_sz=128_fold=0.csv
    md5: 5fa51147ffe77fbf80b2b2042324a73b
    size: 997502
  - path: subs/oof/arch=resnet50_sz=128_fold=0.csv
    md5: 6eae9a6bc67276e3c77c47989b906d67
    size: 1687542
train_resnet18_256:
  cmd: python pipe/train.py --train_data train_256 --test_data test_256 --fold -1
    --arch resnet18 --metric multilabel_auc_macro --opt sam --loss bce_with_logits
    --precision 16 --sz 256 --auto_batch_size power --lr 0.1 --sched plateau --mom
    0.9 --wd 0.0
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: 3187ed89ec371d747d259316c6b2848f
    size: 7368
  outs:
  - path: metrics/arch=resnet18_sz=256.metric
    md5: 1153b1a6f4efc3b2d1a7d88b1e86e919
    size: 31
  - path: models/arch=resnet18_sz=256_fold=0.ckpt
    md5: fad4dc971f52089b132e5599327dc20e
    size: 44787265
  - path: models/arch=resnet18_sz=256_fold=1.ckpt
    md5: 4d757adb6564172c0bcd3ba25ab35186
    size: 44787260
  - path: models/arch=resnet18_sz=256_fold=2.ckpt
    md5: d51ac0f0dd9e86abd54689faadd9d26d
    size: 44787263
  - path: models/arch=resnet18_sz=256_fold=3.ckpt
    md5: 5fff7e132e8424f959964c47b4cf52fb
    size: 44787261
  - path: models/arch=resnet18_sz=256_fold=4.ckpt
    md5: ed1d86697fae231ad9cc14e596f04bab
    size: 44787261
  - path: subs/arch=resnet18_sz=256_fold=0.csv
    md5: 4a0625eaf95845c0d125f2eef49c382f
    size: 992994
  - path: subs/arch=resnet18_sz=256_fold=1.csv
    md5: 25736261bcf6af6fd32f5a15197b79d6
    size: 993245
  - path: subs/arch=resnet18_sz=256_fold=2.csv
    md5: be9f4424c0f0b0ce70ca49f2ef70d6b3
    size: 995257
  - path: subs/arch=resnet18_sz=256_fold=3.csv
    md5: 0e84b192f065039da8aba4747e0f2405
    size: 995498
  - path: subs/arch=resnet18_sz=256_fold=4.csv
    md5: e915b79c7a14018e48be43b81480993d
    size: 996185
  - path: subs/oof/arch=resnet18_sz=256_fold=0.csv
    md5: 43bd50db463439218c71b44cf1897e33
    size: 1683006
  - path: subs/oof/arch=resnet18_sz=256_fold=1.csv
    md5: 803dd04defbc23b35132c3ec5a11597b
    size: 1671302
  - path: subs/oof/arch=resnet18_sz=256_fold=2.csv
    md5: ce1769d4315c5d28d50d7e717898cd3e
    size: 1682856
  - path: subs/oof/arch=resnet18_sz=256_fold=3.csv
    md5: e074571f4fb4fb9e6616d6833bce32ad
    size: 1674491
  - path: subs/oof/arch=resnet18_sz=256_fold=4.csv
    md5: 0c82bcff317772df7606c2c1ff0083f9
    size: 1687539
train_resnet18_512:
  cmd: python pipe/train.py --train_data train_512 --test_data test_512 --fold -1
    --arch resnet18 --metric multilabel_auc_macro --opt sam --loss bce_with_logits
    --precision 16 --sz 512 --auto_batch_size power --lr 0.1 --sched plateau --mom
    0.9 --wd 0.0
  deps:
  - path: data/train_folds.csv
    md5: c0a7355a820dd5f371ba3ffb54eeecd0
    size: 2978438
  - path: pipe/train.py
    md5: 3187ed89ec371d747d259316c6b2848f
    size: 7368
  outs:
  - path: metrics/arch=resnet18_sz=512.metric
    md5: e47d73b18ccfdccdc801d33eedac5564
    size: 31
  - path: models/arch=resnet18_sz=512_fold=0.ckpt
    md5: 670e5dc2c7f7b31715b5cfc5ab29073c
    size: 44787265
  - path: models/arch=resnet18_sz=512_fold=1.ckpt
    md5: dd3e51e371ca50527470135a42611b12
    size: 44787263
  - path: models/arch=resnet18_sz=512_fold=2.ckpt
    md5: d7affcab4a1c2f5b5cd16b66bf75af88
    size: 44787263
  - path: models/arch=resnet18_sz=512_fold=3.ckpt
    md5: a0fc69d358af92e039a9cb33d26e719f
    size: 44787262
  - path: models/arch=resnet18_sz=512_fold=4.ckpt
    md5: cedfc44c2ed6cbef9b40984d6eb77393
    size: 44787261
  - path: subs/arch=resnet18_sz=512_fold=0.csv
    md5: bda95314f269688238afdf23de845700
    size: 992929
  - path: subs/arch=resnet18_sz=512_fold=1.csv
    md5: 478ba6d3521f751002ac713717612030
    size: 996985
  - path: subs/arch=resnet18_sz=512_fold=2.csv
    md5: 1bd42bb730ddb579ebcc31425180db80
    size: 993593
  - path: subs/arch=resnet18_sz=512_fold=3.csv
    md5: cb95dbcfdd6aadc04e4681185108dfa0
    size: 992912
  - path: subs/arch=resnet18_sz=512_fold=4.csv
    md5: d8cdbf3980fc321dadf9caee27a9380a
    size: 993268
  - path: subs/oof/arch=resnet18_sz=512_fold=0.csv
    md5: 0698e17de1086ceb9d135714e6e9d808
    size: 1681914
  - path: subs/oof/arch=resnet18_sz=512_fold=1.csv
    md5: bc3fb1d14014f8e8fa99336c0c15b7e8
    size: 1676567
  - path: subs/oof/arch=resnet18_sz=512_fold=2.csv
    md5: 24491191b40388694f2f476133b68110
    size: 1679655
  - path: subs/oof/arch=resnet18_sz=512_fold=3.csv
    md5: 0c30a5d417d40c90c57b37695d6d5aa0
    size: 1672410
  - path: subs/oof/arch=resnet18_sz=512_fold=4.csv
    md5: f53e3ab4e7603e420b0d58a569973ddd
    size: 1681726
